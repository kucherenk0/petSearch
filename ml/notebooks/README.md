# Описание ноутбуков

---

## EDA.ipynb

```
Датасет  
│
└───Только собака
│   │
│   └───ТОЛЬКО СОБАКА -разноцветный - длинный хвост
│   │
│   └───ТОЛЬКО СОБАКА -разноцветный - короткий хвост
│   │
│   └───ТОЛЬКО СОБАКА СВЕТЛЫЙ ДЛИННЫЙ
│   │
│   └───ТОЛЬКО СОБАКА ТЕМНЫЙ ДЛИННЫЙ
│   │
│   └───ТОЛЬКО СОБАКА ТЕМНЫЙ КОРОТКИЙ
│   │
│   └───ТОЛЬКО СОБАКАЯ СВЕТЛЫЙ КОРОТКИЙ
│   
└───Пустые
│   
└───Хозяин и собака
│   
└───Другие животные
```

Цель данного ноутбука это создание единого датафрейма с колонками
'filename', 'is_animal_there', 'is_it_a_dog', 'is_the_owner_there', 'color', 'tail', 'address', 'cam_id'
С учетом специфики директорий

На основе полученного фатафрейма проведен базовый EDA (Exploratory Data Analysis) c целью анализа соотношений различных категорий столбцов датафрейма. Анализ использует визуализацию seaborn.barplot

---

## dataset_super_res.ipynb

Ноутбук преобразовывает датасет в датасет с повышенным разрешением с помощью Real ESRGAN. Лучше делать на GPU, иначе займёт очень много времени. На Colab Pro скорость составляла порядка 2,5 секунд на изображение.

В клетке запуска скрипта в параметрах `--input` и `--output` можно указать начальную и конечную папки с изображениеями. Важно, чтобы папки были без дополнительных вложенных структур.

---

## select_instances.ipynb

Ноутбук для детекции собак, людей и прочих животных на фотографии. Используемый детектор: `MMDetection` [link to github](https://github.com/open-mmlab/mmdetection). 

Использовался для экспериментов с нужными пороговыми значениями уверенности для детекции сущностей, для генерации масок и коробок для вырезания объектов со всего изображения. Наилучшее пороговое значени для детекции собак: `1e-3`. Точность детекции собак составила:

| Dataset | Balanced accuracy | Precision | Recall |
|---------|-------------------|-----------|--------|
| Train   | 0.807             | 0.901     | 0.854  |
| Test    | 0.792             | 0.916     | 0.794  |


---

## color_classifiaction.ipynb

Ноутбук с попытками классифицировать собак по цветам с использованием простых фичей - среднего и среднеквадратичного отклонения для цвета собаки по маске, для цвета картинки с вырезанной собакой, а так же для поканального среднего и отклонения. Для обработки используются картинки задетектированных собак и вырезанных с исходного изображения с камеры.

Лучшая достигнутая сбалансированная точность классификации - `0.63`. Как видно из 2D проекций датасета фиче, светлые и тёмные собаки разделились хорошо (точность классификации двух классов составила `0.84`), но разноцветные собаки полностью смешались и со светлыми, и с тёмными.

---

## color_classification_NN.ipynb

Ноутбук для классификации собак по цветам с использованием нейросетей. Используется предобученная на ImageNet сеть Resnet. Последний слой заменяется на классификатор для трёх классов и дообучается на данных с вырезанных собак с изображений камер. 

Были проведены эксперименты с размерами сети, аугментациями, разрешениями датасета (обычное и super resolution). Лучший результат:

| Модель     | Test balanced accuracy | Train balanced accuracy |
|------------|------------------------|-------------------------|
| Resnet-50  |   0.700                |  0.779                  |

